{"version":3,"file":"preload.js","sources":["../electron/preload.ts"],"sourcesContent":["import { ipcRenderer, contextBridge } from 'electron';\n\n/**\n * Using the ipcRenderer directly in the browser through the contextBridge ist not really secure.\n * I advise using the Main/api way !!\n */\ncontextBridge.exposeInMainWorld('ipcRenderer', ipcRenderer);\n\n// eslint-disable-next-line no-undef\nfunction domReady(condition: DocumentReadyState[] = ['complete', 'interactive']) {\n  return new Promise((resolve) => {\n    if (condition.includes(document.readyState)) {\n      resolve(true);\n    } else {\n      document.addEventListener('readystatechange', () => {\n        if (condition.includes(document.readyState)) {\n          resolve(true);\n        }\n      });\n    }\n  });\n}\n\nconst safeDOM = {\n  append(parent: HTMLElement, child: HTMLElement) {\n    if (!Array.from(parent.children).find((e) => e === child)) {\n      return parent.appendChild(child);\n    }\n\n    return null;\n  },\n  remove(parent: HTMLElement, child: HTMLElement) {\n    if (parent && Array.from(parent.children).find((e) => e === child)) {\n      return parent.removeChild(child);\n    }\n\n    return null;\n  }\n};\n\n/**\n * https://tobiasahlin.com/spinkit\n * https://connoratherton.com/loaders\n * https://projects.lukehaas.me/css-loaders\n * https://matejkustec.github.io/SpinThatShit\n */\nfunction useLoading() {\n  const styleContent = `\n  .sk-chase {\n  \n  }\n\n  .sk-chase-dot {\n      width: 40px;\n      height: 40px;\n      position: absolute;\n      margin: auto;\n      animation: sk-chase-dot 2.0s infinite ease-in-out both;\n  }\n\n  .sk-chase-dot:before {\n    content: '';\n    display: block;\n    width: 25%;\n    height: 25%;\n    background-color: #fff;\n    border-radius: 100%;\n    animation: sk-chase-dot-before 2.0s infinite ease-in-out both; \n  }\n\n  .sk-chase-dot:nth-child(1) { animation-delay: -1.1s; }\n  .sk-chase-dot:nth-child(2) { animation-delay: -1.0s; }\n  .sk-chase-dot:nth-child(3) { animation-delay: -0.9s; }\n  .sk-chase-dot:nth-child(4) { animation-delay: -0.8s; }\n  .sk-chase-dot:nth-child(5) { animation-delay: -0.7s; }\n  .sk-chase-dot:nth-child(6) { animation-delay: -0.6s; }\n  .sk-chase-dot:nth-child(1):before { animation-delay: -1.1s; }\n  .sk-chase-dot:nth-child(2):before { animation-delay: -1.0s; }\n  .sk-chase-dot:nth-child(3):before { animation-delay: -0.9s; }\n  .sk-chase-dot:nth-child(4):before { animation-delay: -0.8s; }\n  .sk-chase-dot:nth-child(5):before { animation-delay: -0.7s; }\n  .sk-chase-dot:nth-child(6):before { animation-delay: -0.6s; }\n  \n  @keyframes sk-chase {\n    100% { transform: rotate(360deg); } \n  }\n  \n  @keyframes sk-chase-dot {\n    80%, 100% { transform: rotate(360deg); } \n  }\n\n  @keyframes sk-chase-dot-before {\n    50% {\n      transform: scale(0.4); \n    } 100%, 0% {\n      transform: scale(1.0); \n    } \n  }\n\n  .app-loading-wrap {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100vw;\n    height: 100vh;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background: #282c34;\n    z-index: 9;\n  }\n  `;\n\n  const htmlContent = `\n    <div clas=\"sk-chase\">\n      <div class=\"sk-chase-dot\"></div>\n      <div class=\"sk-chase-dot\"></div>\n      <div class=\"sk-chase-dot\"></div>\n      <div class=\"sk-chase-dot\"></div>\n      <div class=\"sk-chase-dot\"></div>\n      <div class=\"sk-chase-dot\"></div>\n    </div>\n  `;\n\n  const oStyle = document.createElement('style');\n  const oDiv = document.createElement('div');\n\n  oStyle.id = 'app-loading-style';\n  oStyle.innerHTML = styleContent;\n  oDiv.id = 'loading-to-remove';\n  oDiv.className = 'app-loading-wrap';\n  oDiv.innerHTML = htmlContent;\n\n  return {\n    appendLoading() {\n      safeDOM.append(document.head, oStyle);\n      safeDOM.append(document.body, oDiv);\n    },\n    removeLoading() {\n      safeDOM.remove(document.head, oStyle);\n      safeDOM.remove(document.body, oDiv);\n    }\n  };\n}\n\nconst { appendLoading, removeLoading } = useLoading();\n\ndomReady().then(appendLoading);\n\ndeclare global {\n  interface Window {\n    Main: typeof api;\n    ipcRenderer: typeof ipcRenderer;\n  }\n}\n\nconst api = {\n  /**\n   * Here you can expose functions to the renderer process\n   * so they can interact with the main (electron) side\n   * without security problems.\n   *\n   * The function below can accessed using `window.Main.sayHello`\n   */\n  sendMessage: (message: string) => {\n    ipcRenderer.send('message', message);\n  },\n  /**\n    Here function for AppBar\n   */\n  Minimize: () => {\n    ipcRenderer.send('minimize');\n  },\n  Maximize: () => {\n    ipcRenderer.send('maximize');\n  },\n  Close: () => {\n    ipcRenderer.send('close');\n  },\n  removeLoading: () => {\n    removeLoading();\n  },\n  /**\n   * Provide an easier way to listen to events\n   */\n  on: (channel: string, callback: (data: any) => void) => {\n    ipcRenderer.on(channel, (_, data) => callback(data));\n  },\n  /**\n   * Prompt capture functionality\n   */\n  capturePrompt: (promptData: any) => {\n    return ipcRenderer.invoke('capture-prompt', promptData);\n  },\n  injectContentScript: () => {\n    return ipcRenderer.invoke('inject-content-script');\n  }\n};\n\ncontextBridge.exposeInMainWorld('Main', api);\n\n// Expose a simpler API for external websites\nconst electronAPI = {\n  capturePrompt: (promptData: any) => {\n    return ipcRenderer.invoke('capture-prompt', promptData);\n  },\n  closeOverlay: () => {\n    return ipcRenderer.invoke('close-overlay');\n  },\n  showOverlay: () => {\n    return ipcRenderer.invoke('show-overlay');\n  }\n};\n\ncontextBridge.exposeInMainWorld('electronAPI', electronAPI);\n"],"names":["contextBridge","ipcRenderer"],"mappings":";;AAMAA,uBAAc,kBAAkB,eAAeC;AAG/C,kBAAkB,YAAkC,CAAC,YAAY,gBAAgB;SACxE,IAAI,QAAQ,CAAC,YAAY;QAC1B,UAAU,SAAS,SAAS,aAAa;cACnC;AAAA,WACH;eACI,iBAAiB,oBAAoB,MAAM;YAC9C,UAAU,SAAS,SAAS,aAAa;kBACnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAOlB,MAAM,UAAU;AAAA,EACd,OAAO,QAAqB,OAAoB;QAC1C,CAAC,MAAM,KAAK,OAAO,UAAU,KAAK,CAAC,MAAM,MAAM,QAAQ;aAClD,OAAO,YAAY;AAAA;WAGrB;AAAA;AAAA,EAET,OAAO,QAAqB,OAAoB;QAC1C,UAAU,MAAM,KAAK,OAAO,UAAU,KAAK,CAAC,MAAM,MAAM,QAAQ;aAC3D,OAAO,YAAY;AAAA;WAGrB;AAAA;AAAA;AAUX,sBAAsB;QACd,eAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;QAkEf,cAAc;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;QAWd,SAAS,SAAS,cAAc;QAChC,OAAO,SAAS,cAAc;SAE7B,KAAK;SACL,YAAY;OACd,KAAK;OACL,YAAY;OACZ,YAAY;SAEV;AAAA,IACL,gBAAgB;cACN,OAAO,SAAS,MAAM;cACtB,OAAO,SAAS,MAAM;AAAA;AAAA,IAEhC,gBAAgB;cACN,OAAO,SAAS,MAAM;cACtB,OAAO,SAAS,MAAM;AAAA;AAAA;AAAA;AAKpC,MAAM,EAAE,eAAe,kBAAkB;AAEzC,WAAW,KAAK;AAShB,MAAM,MAAM;AAAA,EAQV,aAAa,CAAC,YAAoB;yBACpB,KAAK,WAAW;AAAA;AAAA,EAK9B,UAAU,MAAM;yBACF,KAAK;AAAA;AAAA,EAEnB,UAAU,MAAM;yBACF,KAAK;AAAA;AAAA,EAEnB,OAAO,MAAM;yBACC,KAAK;AAAA;AAAA,EAEnB,eAAe,MAAM;;;EAMrB,IAAI,CAAC,SAAiB,aAAkC;yBAC1C,GAAG,SAAS,CAAC,GAAG,SAAS,SAAS;AAAA;AAAA,EAKhD,eAAe,CAAC,eAAoB;WAC3BA,qBAAY,OAAO,kBAAkB;AAAA;AAAA,EAE9C,qBAAqB,MAAM;WAClBA,qBAAY,OAAO;AAAA;AAAA;AAI9BD,uBAAc,kBAAkB,QAAQ;AAGxC,MAAM,cAAc;AAAA,EAClB,eAAe,CAAC,eAAoB;WAC3BC,qBAAY,OAAO,kBAAkB;AAAA;AAAA,EAE9C,cAAc,MAAM;WACXA,qBAAY,OAAO;AAAA;AAAA,EAE5B,aAAa,MAAM;WACVA,qBAAY,OAAO;AAAA;AAAA;AAI9BD,uBAAc,kBAAkB,eAAe;"}